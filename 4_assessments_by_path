/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var imageCollection = ee.ImageCollection("projects/sites-project/baselines_v5-3_by_path_monitoring");
/***** End of imports. If edited, may not auto-convert in the playground. *****/

var experiments = imageCollection.aggregate_array('name').distinct()

var result = imageCollection.filterMetadata('name', 'equals', experiments.get(0))
Map.addLayer(result.select('score_mean'))

var weightScore = function(image) {
 var score = image.select('score_mean')
 var nobs = image.select('score_count')
 var weighted = score.multiply(nobs).rename('score_weighted')
 
 return image.addBands(weighted)
}

var totalObs = result.select('score_count').reduce('sum')
print(totalObs)
Map.addLayer(totalObs, {min: 0, max:13})

var resultWts = result.map(weightScore)
print(resultWts)

var resultFinal = resultWts.select('score_weighted').reduce('sum').divide(totalObs)
Map.addLayer(resultFinal)